                .machine CommanderX16R40
.byte $0C, $08, $0A, $00, $9E, $20, $32, $30, $36, $34, $00, $00, $00, $00, $00
.org $810
                    sei

                    lda #02
                    sta DC_BORDER

                    lda #$a0        ; map is at $14000
                    sta L1_MAPBASE

                    stz L1_TILEBASE ; 8x8, tiles are at $00000

                    ; Tile definition
                    lda #$10
                    sta ADDRx_H
                    lda #$00
                    sta ADDRx_M
                    lda #$00
                    sta ADDRx_L
    
                    ; write a tile
                    lda #$f0
                    sta DATA0
                    lda #$f0
                    sta DATA0
                    lda #$f0
                    sta DATA0
                    lda #$f0
                    sta DATA0
                    lda #$0f
                    sta DATA0
                    lda #$0f
                    sta DATA0
                    lda #$0f
                    sta DATA0
                    lda #$0f
                    sta DATA0

                    ; Tile map details - top left
                    lda #$11
                    sta ADDRx_H
                    lda #$40
                    sta ADDRx_M
                    lda #$00
                    sta ADDRx_L

                    lda #01;

                    ldy #60
                .line_loop:
                    ldx #128

                .step_loop:
                    stz DATA0   ; tile number
                    sta DATA0   ; colour

                    inc

                    dex
                    bne step_loop

                    dey
                    bne line_loop

                    ldy #4
                .line_loop2:
                    ldx #128

                .step_loop2:
                    stz DATA0   ; tile number
                    stz DATA0   ; colour

                    inc

                    dex
                    bne step_loop2

                    dey
                    bne line_loop2

                    ; background colour
                    lda #$11
                    sta ADDRx_H
                    lda #$fa
                    sta ADDRx_M
                    lda #$00
                    sta ADDRx_L
    
                    lda #$12
                    sta DATA0

                    lda #$60        
                    sta L1_CONFIG

                    lda #$21
                    sta DC_VIDEO ; enable layer 1

                    ldx #200
                    stx DC_VSCALE  
                    ldx #128
                    stx DC_HSCALE
    
                .loop:
                    jmp loop